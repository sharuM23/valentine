function toggleEnvelope() {
  document.getElementById("envelope").classList.toggle("open");
}

const noBtn = document.getElementById("no-btn");
const yesBtn = document.getElementById("yes-btn");
const hero = document.getElementById("hero-section");
const story = document.getElementById("story-section");
let initialMove = false;

// No Button Logic
const moveNo = (e) => {
  if (e.type === "touchstart") e.preventDefault();
  if (!initialMove) {
    const rect = noBtn.getBoundingClientRect();
    noBtn.style.left = `${rect.left}px`;
    noBtn.style.top = `${rect.top}px`;
    noBtn.style.position = "fixed";
    noBtn.style.margin = "0";
    initialMove = true;
  }
  const maxX = window.innerWidth - noBtn.offsetWidth - 30;
  const maxY = window.innerHeight - noBtn.offsetHeight - 30;
  noBtn.style.left = `${Math.floor(Math.random() * maxX)}px`;
  noBtn.style.top = `${Math.floor(Math.random() * maxY)}px`;
};

noBtn.addEventListener("mouseenter", moveNo);
noBtn.addEventListener("touchstart", moveNo, { passive: false });

// Page Transition
yesBtn.addEventListener("click", () => {
  hero.style.opacity = "0";
  hero.style.transition = "0.8s";
  setTimeout(() => {
    hero.style.display = "none";
    story.style.display = "block";
    window.scrollTo({ top: 0, behavior: "smooth" });
    setInterval(createHeart, 300);
  }, 800);
});

// Heart Rain
function createHeart() {
  const heart = document.createElement("div");
  heart.innerHTML = "❤️";
  heart.style.cssText = `position:fixed; bottom:-10%; left:${
    Math.random() * 100
  }vw; animation:fUp 4s linear forwards; color:#ff4d6d; z-index:-1; font-size:20px;`;
  document.body.appendChild(heart);
  setTimeout(() => heart.remove(), 4000);
}

const s = document.createElement("style");
s.innerHTML = `@keyframes fUp { to { transform: translateY(-110vh) rotate(360deg); opacity: 0; } }`;
document.head.appendChild(s);
